{% extends "base.html" %}

{% block title %}Edukate - Online Education{% endblock %}

{% block page_title %}Edukate Home{% endblock %}

{% block content %}
<div class="container-fluid py-5">
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-7 mb-5 mb-lg-0">
                <div class="section-title position-relative mb-4">
                    <h6 class="d-inline-block position-relative text-secondary text-uppercase pb-2">Why Choose Us?</h6>
                    <h1 class="display-4">Best Courses for Your Future</h1>
                </div>
                <p class="mb-4 pb-2">Join a community of learners and master new skills with our expert-led courses. Flexible learning for a modern world.</p>
                <div class="d-flex mb-3">
                    <div class="btn-icon bg-primary mr-4">
                        <i class="fa fa-2x fa-graduation-cap text-white"></i>
                    </div>
                    <div class="mt-n1">
                        <h4>Skilled Instructors</h4>
                        <p>Learn from industry experts with real-world experience.</p>
                    </div>
                </div>
                <div class="d-flex mb-3">
                    <div class="btn-icon bg-secondary mr-4">
                        <i class="fa fa-2x fa-certificate text-white"></i>
                    </div>
                    <div class="mt-n1">
                        <h4>International Certificate</h4>
                        <p>Earn recognized certificates to boost your career.</p>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="btn-icon bg-warning mr-4">
                        <i class="fa fa-2x fa-book-reader text-white"></i>
                    </div>
                    <div class="mt-n1">
                        <h4>Online Classes</h4>
                        <p class="m-0">Access content anytime, anywhere, on any device.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-5" style="min-height: 500px;">
                <div class="position-relative h-100">
                    <img class="position-absolute w-100 h-100" src="{{ url_for('static', filename='img/feature.jpg') }}" style="object-fit: cover;">
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid py-5">
    <div class="container py-5">
        <div class="row mx-0 justify-content-center">
            <div class="col-lg-8">
                <div class="section-title text-center position-relative mb-5">
                    <h6 class="d-inline-block position-relative text-secondary text-uppercase pb-2">Our Courses</h6>
                    <h1 class="display-4">Checkout New Releases</h1>
                </div>
            </div>
        </div>
        
        <div id="courses-container" class="owl-carousel courses-carousel">
            <div class="text-center p-5">
                 <div class="spinner-border text-primary" role="status">
                     <span class="sr-only">Loading...</span>
                 </div>
             </div>
        </div>
    </div>
</div>

<div class="container-fluid py-5">
    <div class="container pt-5 pb-3">
        <div class="row mx-0 justify-content-center">
            <div class="col-lg-8">
                <div class="section-title text-center position-relative mb-5">
                    <h6 class="d-inline-block position-relative text-secondary text-uppercase pb-2">Our Instructors</h6>
                    <h1 class="display-4">Meet Our Certified & Experienced Instructors</h1>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-3 col-md-6 pb-4">
                <div class="team-item">
                    <img class="img-fluid mb-4" src="{{ url_for('static', filename='img/team-1.jpg') }}" alt="">
                    <div class="bg-light p-4">
                        <h4 class="mb-3">Alan Turing</h4>
                        <p class="m-0">Computer Science</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 pb-4">
                <div class="team-item">
                    <img class="img-fluid mb-4" src="{{ url_for('static', filename='img/team-2.jpg') }}" alt="">
                    <div class="bg-light p-4">
                        <h4 class="mb-3">Ada Lovelace</h4>
                        <p class="m-0">Software Engineering</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 pb-4">
                <div class="team-item">
                    <img class="img-fluid mb-4" src="{{ url_for('static', filename='img/team-3.jpg') }}" alt="">
                    <div class="bg-light p-4">
                        <h4 class="mb-3">Grace Hopper</h4>
                        <p class="m-0">Mathematics</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 pb-4">
                <div class="team-item">
                    <img class="img-fluid mb-4" src="{{ url_for('static', filename='img/team-4.jpg') }}" alt="">
                    <div class="bg-light p-4">
                        <h4 class="mb-3">Siti Nurhaliza</h4>
                        <p class="m-0">General Studies</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', loadHomeCourses);

    async function loadHomeCourses() {
        const container = document.getElementById('courses-container');
        
        try {
            // Fetch data from API
            const courses = await apiFetch('/api/courses');
            
            if (!courses || courses.length === 0) {
                container.innerHTML = '<div class="text-center w-100">No courses available at the moment.</div>';
                return;
            }

            // Generate HTML for courses
            // Limit to first 6 for the homepage carousel
            const featuredCourses = courses.slice(0, 6);
            
            let htmlContent = featuredCourses.map((course, index) => {
                const imgNum = (index % 6) + 1; // Cycle images 1-6
                const detailUrl = `/course/${course.course_id}`;
                
                return `
                <div class="courses-list-item position-relative d-block overflow-hidden mb-2" style="margin-right: 10px;">
                    <a href="${detailUrl}">
                        <img class="img-fluid" src="/static/img/courses-${imgNum}.jpg" alt="${course.course_name}">
                        <div class="courses-text">
                            <h4 class="text-center text-white px-3">${course.course_code} - ${course.course_name}</h4>
                            <div class="border-top w-100 mt-3">
                                <div class="d-flex justify-content-between p-4">
                                    <span class="text-white"><i class="fa fa-user mr-2"></i>${course.instructor_name || 'TBA'}</span>
                                    <span class="text-white"><i class="fa fa-book-open mr-2"></i>${course.credits} Credits</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                `;
            }).join('');

            // Destroy existing carousel if initialized (rare on first load but good practice)
            if ($(container).data('owl.carousel')) {
                $(container).trigger('destroy.owl.carousel');
            }

            // Inject HTML
            container.innerHTML = htmlContent;

            // Initialize Owl Carousel
            $(container).owlCarousel({
                autoplay: true,
                smartSpeed: 1500,
                items: 1,
                dots: false,
                loop: true,
                nav : true,
                navText : [
                    '<i class="fa fa-angle-left" aria-hidden="true"></i>',
                    '<i class="fa fa-angle-right" aria-hidden="true"></i>'
                ],
                responsive: {
                    0:{ items:1 },
                    576:{ items:1 },
                    768:{ items:2 },
                    992:{ items:3 }
                }
            });

        } catch (error) {
            console.error('Failed to load courses:', error);
            container.innerHTML = '<div class="text-center text-danger w-100">Failed to load courses.</div>';
        }
    }
</script>
{% endblock %}